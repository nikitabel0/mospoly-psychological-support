# –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –ø—Ä–æ–µ–∫—Ç–∞ "–ü—Å–∏—Ö–æ–ª–æ–≥–∏—á–µ—Å–∫–∞—è —Å–ª—É–∂–±–∞ –ú–æ—Å–ü–æ–ª–∏"

## –°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ

1. [–û–±–∑–æ—Ä –ø—Ä–æ–µ–∫—Ç–∞](#–æ–±–∑–æ—Ä-–ø—Ä–æ–µ–∫—Ç–∞-–ø—Å–∏—Ö–æ–ª–æ–≥–∏—á–µ—Å–∫–∞—è-—Å–ª—É–∂–±–∞-–º–æ—Å–ø–æ–ª–∏)
2. [–ë–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞ —Å–∏—Å—Ç–µ–º—ã](#–±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞-—Å–∏—Å—Ç–µ–º—ã)
3. [–ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã —Å–∏—Å—Ç–µ–º—ã](#–∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã-—Å–∏—Å—Ç–µ–º—ã)

---

# –û–±–∑–æ—Ä –ø—Ä–æ–µ–∫—Ç–∞ "–ü—Å–∏—Ö–æ–ª–æ–≥–∏—á–µ—Å–∫–∞—è —Å–ª—É–∂–±–∞ –ú–æ—Å–ü–æ–ª–∏"

## –û–ø–∏—Å–∞–Ω–∏–µ

–ü—Ä–æ–µ–∫—Ç –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç —Å–æ–±–æ–π –≤–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏ —Ä–∞–±–æ—Ç—ã –ø—Å–∏—Ö–æ–ª–æ–≥–∏—á–µ—Å–∫–æ–π —Å–ª—É–∂–±—ã –ú–æ—Å–ü–æ–ª–∏. –°–∏—Å—Ç–µ–º–∞ –ø–æ–∑–≤–æ–ª—è–µ—Ç —Å—Ç—É–¥–µ–Ω—Ç–∞–º –∑–∞–ø–∏—Å—ã–≤–∞—Ç—å—Å—è –Ω–∞ –∫–æ–Ω—Å—É–ª—å—Ç–∞—Ü–∏–∏ –∫ –ø—Å–∏—Ö–æ–ª–æ–≥–∞–º —É–Ω–∏–≤–µ—Ä—Å–∏—Ç–µ—Ç–∞, –∞ –ø—Å–∏—Ö–æ–ª–æ–≥–∞–º ‚Äî —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ —É–ø—Ä–∞–≤–ª—è—Ç—å —Å–≤–æ–∏–º —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–µ–º –∏ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–æ–≤–∞—Ç—å —Å –∫–ª–∏–µ–Ω—Ç–∞–º–∏.

## –¶–µ–ª–∏ –∏ –∑–∞–¥–∞—á–∏

### –û—Å–Ω–æ–≤–Ω—ã–µ —Ü–µ–ª–∏:
1. **–£–ø—Ä–æ—â–µ–Ω–∏–µ –ø—Ä–æ—Ü–µ—Å—Å–∞ –∑–∞–ø–∏—Å–∏** - —Å—Ç—É–¥–µ–Ω—Ç—ã –º–æ–≥—É—Ç —Å–∞–º–æ—Å—Ç–æ—è—Ç–µ–ª—å–Ω–æ –∑–∞–ø–∏—Å–∞—Ç—å—Å—è –Ω–∞ –∫–æ–Ω—Å—É–ª—å—Ç–∞—Ü–∏—é
2. **–¶–µ–Ω—Ç—Ä–∞–ª–∏–∑–∞—Ü–∏—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏** - –≤—Å—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –ø—Å–∏—Ö–æ–ª–æ–≥–∞—Ö –∏ –∑–∞–ø–∏—Å—è—Ö –≤ –æ–¥–Ω–æ–º –º–µ—Å—Ç–µ
3. **–ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è** - —É–º–µ–Ω—å—à–µ–Ω–∏–µ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–∏–≤–Ω–æ–π –Ω–∞–≥—Ä—É–∑–∫–∏
4. **–ü–æ–≤—ã—à–µ–Ω–∏–µ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏** - –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –æ–Ω–ª–∞–π–Ω-–∫–æ–Ω—Å—É–ª—å—Ç–∞—Ü–∏–π

### –ó–∞–¥–∞—á–∏ —Å–∏—Å—Ç–µ–º—ã:
- ‚úÖ –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –∏ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- ‚úÖ –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–æ—Ñ–∏–ª—è–º–∏ –ø—Å–∏—Ö–æ–ª–æ–≥–æ–≤ —Å –¥–µ—Ç–∞–ª—å–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π
- ‚úÖ –°–æ–∑–¥–∞–Ω–∏–µ –∏ –æ—Ç–º–µ–Ω–∞ –∑–∞–ø–∏—Å–µ–π –Ω–∞ –∫–æ–Ω—Å—É–ª—å—Ç–∞—Ü–∏–∏
- ‚úÖ –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –æ–Ω–ª–∞–π–Ω –∏ –æ—Ñ–ª–∞–π–Ω –≤—Å—Ç—Ä–µ—á
- ‚úÖ –°–∏—Å—Ç–µ–º–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π –æ –ø—Ä–µ–¥—Å—Ç–æ—è—â–∏—Ö –≤—Å—Ç—Ä–µ—á–∞—Ö
- ‚úÖ –°–±–æ—Ä –∏ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –æ—Ç–∑—ã–≤–æ–≤ –æ –∫–æ–Ω—Å—É–ª—å—Ç–∞—Ü–∏—è—Ö
- ‚úÖ –†–∞–∑–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –ø—Ä–∞–≤ –¥–æ—Å—Ç—É–ø–∞ –ø–æ —Ä–æ–ª—è–º

## –¶–µ–ª–µ–≤–∞—è –∞—É–¥–∏—Ç–æ—Ä–∏—è

### 1. –°—Ç—É–¥–µ–Ω—Ç—ã
- –û—Å–Ω–æ–≤–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ —Å–∏—Å—Ç–µ–º—ã
- –ó–∞–ø–∏—Å—ã–≤–∞—é—Ç—Å—è –Ω–∞ –∫–æ–Ω—Å—É–ª—å—Ç–∞—Ü–∏–∏
- –ü—Ä–æ—Å–º–∞—Ç—Ä–∏–≤–∞—é—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –ø—Å–∏—Ö–æ–ª–æ–≥–∞—Ö
- –û—Å—Ç–∞–≤–ª—è—é—Ç –æ—Ç–∑—ã–≤—ã –ø–æ—Å–ª–µ –≤—Å—Ç—Ä–µ—á

### 2. –ü—Å–∏—Ö–æ–ª–æ–≥–∏
- –ü—Ä–æ—Å–º–∞—Ç—Ä–∏–≤–∞—é—Ç —Å–≤–æ–∏ –∑–∞–ø–∏—Å–∏
- –£–ø—Ä–∞–≤–ª—è—é—Ç —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–µ–º
- –ü—Ä–æ–≤–æ–¥—è—Ç –∫–æ–Ω—Å—É–ª—å—Ç–∞—Ü–∏–∏ (–æ–Ω–ª–∞–π–Ω –∏ –æ—Ñ–ª–∞–π–Ω)

### 3. –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä—ã
- –£–ø—Ä–∞–≤–ª—è—é—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏
- –î–æ–±–∞–≤–ª—è—é—Ç –∏ —Ä–µ–¥–∞–∫—Ç–∏—Ä—É—é—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –ø—Å–∏—Ö–æ–ª–æ–≥–∞—Ö
- –ú–æ–¥–µ—Ä–∏—Ä—É—é—Ç –∫–æ–Ω—Ç–µ–Ω—Ç

### 4. –ü–µ—Ä—Å–æ–Ω–∞–ª (Stuff)
- –í—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–π –ø–µ—Ä—Å–æ–Ω–∞–ª —Å–ª—É–∂–±—ã
- –ü–æ–º–æ–≥–∞—é—Ç —Å –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–µ–π –∫–æ–Ω—Å—É–ª—å—Ç–∞—Ü–∏–π

## –ö–ª—é—á–µ–≤—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏

### –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏
- –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è —Å –≤–∞–ª–∏–¥–∞—Ü–∏–µ–π –¥–∞–Ω–Ω—ã—Ö
- –í—Ö–æ–¥ —á–µ—Ä–µ–∑ email –∏ –ø–∞—Ä–æ–ª—å
- JWT-–∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è —Å HTTP-only cookies
- –ü—Ä–æ—Ñ–∏–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π —Å –∫–æ–Ω—Ç–∞–∫—Ç–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π

### –°–∏—Å—Ç–µ–º–∞ –∑–∞–ø–∏—Å–µ–π
- –°–æ–∑–¥–∞–Ω–∏–µ –∑–∞–ø–∏—Å–∏ –Ω–∞ –∫–æ–Ω—Å—É–ª—å—Ç–∞—Ü–∏—é
- –í—ã–±–æ—Ä —Ç–∏–ø–∞ –≤—Å—Ç—Ä–µ—á–∏ (–æ–Ω–ª–∞–π–Ω/–æ—Ñ–ª–∞–π–Ω)
- –£–∫–∞–∑–∞–Ω–∏–µ –ø—Ä–∏—á–∏–Ω—ã –æ–±—Ä–∞—â–µ–Ω–∏—è
- –ù–∞–ø–æ–º–∏–Ω–∞–Ω–∏—è –æ –ø—Ä–µ–¥—Å—Ç–æ—è—â–∏—Ö –≤—Å—Ç—Ä–µ—á–∞—Ö
- –û—Ç–º–µ–Ω–∞ –∑–∞–ø–∏—Å–µ–π
- –ò—Å—Ç–æ—Ä–∏—è –≤—Å—Ç—Ä–µ—á

### –ü—Ä–æ—Ñ–∏–ª–∏ –ø—Å–∏—Ö–æ–ª–æ–≥–æ–≤
- –ü–æ–¥—Ä–æ–±–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Å–ø–µ—Ü–∏–∞–ª–∏—Å—Ç–∞—Ö
- –û–ø—ã—Ç —Ä–∞–±–æ—Ç—ã –∏ –∫–≤–∞–ª–∏—Ñ–∏–∫–∞—Ü–∏—è
- –û–±–ª–∞—Å—Ç–∏ –∫–æ–Ω—Å—É–ª—å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
- –û–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ
- –ù–æ–º–µ—Ä –∫–∞–±–∏–Ω–µ—Ç–∞
- –§–æ—Ç–æ–≥—Ä–∞—Ñ–∏—è
- –ö—Ä–∞—Ç–∫–æ–µ –∏ –ø–æ–ª–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ

### –û—Ç–∑—ã–≤—ã
- –û—Ç–∑—ã–≤—ã –ø—Ä–∏–≤—è–∑–∞–Ω—ã –∫ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–π –≤—Å—Ç—Ä–µ—á–µ
- –í—Ä–µ–º–µ–Ω–Ω–∞—è –º–µ—Ç–∫–∞
- –¢–µ–∫—Å—Ç–æ–≤—ã–π –∫–æ–Ω—Ç–µ–Ω—Ç

## –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ —Å–∏—Å—Ç–µ–º—ã

1. **–î–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å 24/7** - –∑–∞–ø–∏—Å—å –≤ –ª—é–±–æ–µ –≤—Ä–µ–º—è
2. **–ü—Ä–æ–∑—Ä–∞—á–Ω–æ—Å—Ç—å** - –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –ø—Å–∏—Ö–æ–ª–æ–≥–∞—Ö –≤—Å–µ–≥–¥–∞ –¥–æ—Å—Ç—É–ø–Ω–∞
3. **–£–¥–æ–±—Å—Ç–≤–æ** - –ø—Ä–æ—Å—Ç–æ–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –∏ –ø–æ–Ω—è—Ç–Ω–∞—è –Ω–∞–≤–∏–≥–∞—Ü–∏—è
4. **–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å** - –∑–∞—â–∏—Ç–∞ –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
5. **–ì–∏–±–∫–æ—Å—Ç—å** - –ø–æ–¥–¥–µ—Ä–∂–∫–∞ –æ–Ω–ª–∞–π–Ω –∏ –æ—Ñ–ª–∞–π–Ω —Ñ–æ—Ä–º–∞—Ç–æ–≤
6. **–ê–Ω–∞–ª–∏—Ç–∏–∫–∞** - –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –∞–Ω–∞–ª–∏–∑–∞ –∑–∞–≥—Ä—É–∂–µ–Ω–Ω–æ—Å—Ç–∏ —Å–ª—É–∂–±—ã


# –ë–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞ —Å–∏—Å—Ç–µ–º—ã

## –û—Å–Ω–æ–≤–Ω—ã–µ –±–∏–∑–Ω–µ—Å-–ø—Ä–æ—Ü–µ—Å—Å—ã

### 1. üîê –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –∏ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è

#### –ü—Ä–æ—Ü–µ—Å—Å —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å‚îÇ
‚îÇ  –≤–≤–æ–¥–∏—Ç     ‚îÇ
‚îÇ  –¥–∞–Ω–Ω—ã–µ     ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
       ‚îÇ
       ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ –í–∞–ª–∏–¥–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö (Pydantic)  ‚îÇ
‚îÇ - Email —Ñ–æ—Ä–º–∞—Ç               ‚îÇ
‚îÇ - –¢–µ–ª–µ—Ñ–æ–Ω –≤ —Ñ–æ—Ä–º–∞—Ç–µ E164     ‚îÇ
‚îÇ - –ü–∞—Ä–æ–ª—å –º–∏–Ω–∏–º—É–º 8 —Å–∏–º–≤–æ–ª–æ–≤  ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
       ‚îÇ
       ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ –ü—Ä–æ–≤–µ—Ä–∫–∞ —É–Ω–∏–∫–∞–ª—å–Ω–æ—Å—Ç–∏ email  ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
       ‚îÇ
       ‚îú‚îÄ‚îÄ‚îÄ Email —Å—É—â–µ—Å—Ç–≤—É–µ—Ç ‚Üí –û—à–∏–±–∫–∞ 422
       ‚îÇ
       ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ –•–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–∞—Ä–æ–ª—è (bcrypt)  ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
       ‚îÇ
       ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ –°–æ–∑–¥–∞–Ω–∏–µ –∑–∞–ø–∏—Å–∏ –≤ –ë–î         ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
       ‚îÇ
       ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ –ì–µ–Ω–µ—Ä–∞—Ü–∏—è JWT —Ç–æ–∫–µ–Ω–∞         ‚îÇ
‚îÇ - sub: user_id               ‚îÇ
‚îÇ - exp: —Ç–µ–∫—É—â–µ–µ –≤—Ä–µ–º—è + TTL   ‚îÇ
‚îÇ - iat: —Ç–µ–∫—É—â–µ–µ –≤—Ä–µ–º—è         ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
       ‚îÇ
       ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ –£—Å—Ç–∞–Ω–æ–≤–∫–∞ cookie —Å —Ç–æ–∫–µ–Ω–æ–º   ‚îÇ
‚îÇ - HttpOnly                   ‚îÇ
‚îÇ - Secure (prod)              ‚îÇ
‚îÇ - SameSite=None              ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
       ‚îÇ
       ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ –í–æ–∑–≤—Ä–∞—Ç –¥–∞–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è  ‚îÇ
‚îÇ (–±–µ–∑ –ø–∞—Ä–æ–ª—è)                 ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

**–ö–æ–¥**: `psychohelp/services/users.py::register_user`

**–ë–∏–∑–Ω–µ—Å-–ø—Ä–∞–≤–∏–ª–∞**:
1. Email –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å —É–Ω–∏–∫–∞–ª—å–Ω—ã–º
2. –ü–∞—Ä–æ–ª—å —Ö–µ—à–∏—Ä—É–µ—Ç—Å—è –∏ –Ω–∏–∫–æ–≥–¥–∞ –Ω–µ —Ö—Ä–∞–Ω–∏—Ç—Å—è –≤ –æ—Ç–∫—Ä—ã—Ç–æ–º –≤–∏–¥–µ
3. –ü–æ—Å–ª–µ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω
4. –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –∏–º–µ–µ—Ç —Ä–æ–ª–µ–π (–µ—Å–ª–∏ –Ω–µ —É–∫–∞–∑–∞–Ω–æ –∏–Ω–∞—á–µ)

---

#### –ü—Ä–æ—Ü–µ—Å—Å –≤—Ö–æ–¥–∞

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å‚îÇ
‚îÇ –≤–≤–æ–¥–∏—Ç      ‚îÇ
‚îÇ email+pass  ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
       ‚îÇ
       ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ –ü–æ–∏—Å–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –ø–æ email  ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
       ‚îÇ
       ‚îú‚îÄ‚îÄ‚îÄ –ù–µ –Ω–∞–π–¥–µ–Ω ‚Üí –û—à–∏–±–∫–∞ 401
       ‚îÇ
       ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–∞—Ä–æ–ª—è              ‚îÇ
‚îÇ bcrypt.verify(plain, hash)   ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
       ‚îÇ
       ‚îú‚îÄ‚îÄ‚îÄ –ù–µ —Å–æ–≤–ø–∞–¥–∞–µ—Ç ‚Üí –û—à–∏–±–∫–∞ 401
       ‚îÇ
       ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ –ì–µ–Ω–µ—Ä–∞—Ü–∏—è JWT —Ç–æ–∫–µ–Ω–∞         ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
       ‚îÇ
       ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ –£—Å—Ç–∞–Ω–æ–≤–∫–∞ cookie             ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
       ‚îÇ
       ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ –í–æ–∑–≤—Ä–∞—Ç –¥–∞–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è  ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

**–ö–æ–¥**: `psychohelp/services/users.py::login_user`

**–ë–∏–∑–Ω–µ—Å-–ø—Ä–∞–≤–∏–ª–∞**:
1. –ù–µ–≤–µ—Ä–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –Ω–µ —Ä–∞—Å–∫—Ä—ã–≤–∞—é—Ç, —á—Ç–æ –∏–º–µ–Ω–Ω–æ –Ω–µ–≤–µ—Ä–Ω–æ (email –∏–ª–∏ –ø–∞—Ä–æ–ª—å)
2. –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –º–µ–¥–ª–µ–Ω–Ω–æ–µ —Ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ bcrypt (–∑–∞—â–∏—Ç–∞ –æ—Ç –±—Ä—É—Ç—Ñ–æ—Ä—Å–∞)
3. –¢–æ–∫–µ–Ω –∏–º–µ–µ—Ç –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω–æ–µ –≤—Ä–µ–º—è –∂–∏–∑–Ω–∏

---

### 2. üìÖ –°–æ–∑–¥–∞–Ω–∏–µ –∑–∞–ø–∏—Å–∏ –Ω–∞ –∫–æ–Ω—Å—É–ª—å—Ç–∞—Ü–∏—é

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ –°—Ç—É–¥–µ–Ω—Ç     ‚îÇ
‚îÇ –≤—ã–±–∏—Ä–∞–µ—Ç    ‚îÇ
‚îÇ –ø—Å–∏—Ö–æ–ª–æ–≥–∞   ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
       ‚îÇ
       ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ –ó–∞–ø–æ–ª–Ω–µ–Ω–∏–µ —Ñ–æ—Ä–º—ã –∑–∞–ø–∏—Å–∏:     ‚îÇ
‚îÇ - –¢–∏–ø (Online/Offline)       ‚îÇ
‚îÇ - –ü—Ä–∏—á–∏–Ω–∞ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)      ‚îÇ
‚îÇ - –í—Ä–µ–º—è –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏—è          ‚îÇ
‚îÇ - –ú–µ—Å—Ç–æ –≤—Å—Ç—Ä–µ—á–∏              ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
       ‚îÇ
       ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ –í–∞–ª–∏–¥–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö             ‚îÇ
‚îÇ - patient_id —Å—É—â–µ—Å—Ç–≤—É–µ—Ç      ‚îÇ
‚îÇ - therapist_id —Å—É—â–µ—Å—Ç–≤—É–µ—Ç    ‚îÇ
‚îÇ - patient_id ‚â† therapist_id  ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
       ‚îÇ
       ‚îú‚îÄ‚îÄ‚îÄ –û—à–∏–±–∫–∞ ‚Üí 400
       ‚îÇ
       ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ –°–æ–∑–¥–∞–Ω–∏–µ –∑–∞–ø–∏—Å–∏:             ‚îÇ
‚îÇ - status = "Approved"        ‚îÇ
‚îÇ - last_change_time = now()   ‚îÇ
‚îÇ - venue = —É–∫–∞–∑–∞–Ω–Ω–æ–µ –∏–ª–∏ ""   ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
       ‚îÇ
       ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ –ë–î              ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
       ‚îÇ
       ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ –í–æ–∑–≤—Ä–∞—Ç —Å–æ–∑–¥–∞–Ω–Ω–æ–π –∑–∞–ø–∏—Å–∏     ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

**–ö–æ–¥**: `psychohelp/services/appointments.py::create_appointment`

**–ë–∏–∑–Ω–µ—Å-–ø—Ä–∞–≤–∏–ª–∞**:
1. **–ü–∞—Ü–∏–µ–Ω—Ç –Ω–µ –º–æ–∂–µ—Ç –±—ã—Ç—å —Ç–µ—Ä–∞–ø–µ–≤—Ç–æ–º** –≤ –æ–¥–Ω–æ–π –∑–∞–ø–∏—Å–∏
2. **–°—Ç–∞—Ç—É—Å –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é**: `Approved` (–æ–¥–æ–±—Ä–µ–Ω–∞)
3. **Venue –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ**: –¥–ª—è Online - —Å—Å—ã–ª–∫–∞, –¥–ª—è Offline - –∫–∞–±–∏–Ω–µ—Ç
4. **last_change_time**: –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏
5. –ü—Ä–∏—á–∏–Ω–∞ –æ–±—Ä–∞—â–µ–Ω–∏—è –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–∞ (–∫–æ–Ω—Ñ–∏–¥–µ–Ω—Ü–∏–∞–ª—å–Ω–æ—Å—Ç—å)

**–í–æ–∑–º–æ–∂–Ω—ã–µ —Å—Ç–∞—Ç—É—Å—ã –∑–∞–ø–∏—Å–∏**:
- `Approved` - –û–¥–æ–±—Ä–µ–Ω–∞ (—Å–æ–∑–¥–∞–Ω–∞)
- `Accepted` - –ü—Ä–∏–Ω—è—Ç–∞ (–ø—Å–∏—Ö–æ–ª–æ–≥ –ø–æ–¥—Ç–≤–µ—Ä–¥–∏–ª)
- `Cancelled` - –û—Ç–º–µ–Ω–µ–Ω–∞
- `Done` - –ó–∞–≤–µ—Ä—à–µ–Ω–∞

---

### 3. ‚ùå –û—Ç–º–µ–Ω–∞ –∑–∞–ø–∏—Å–∏

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å‚îÇ
‚îÇ –æ—Ç–º–µ–Ω—è–µ—Ç    ‚îÇ
‚îÇ –∑–∞–ø–∏—Å—å      ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
       ‚îÇ
       ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ –ü–æ–∏—Å–∫ –∑–∞–ø–∏—Å–∏ –ø–æ ID           ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
       ‚îÇ
       ‚îú‚îÄ‚îÄ‚îÄ –ù–µ –Ω–∞–π–¥–µ–Ω–∞ ‚Üí 404
       ‚îÇ
       ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ç–µ–∫—É—â–µ–≥–æ —Å—Ç–∞—Ç—É—Å–∞    ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
       ‚îÇ
       ‚îú‚îÄ‚îÄ‚îÄ –£–∂–µ –æ—Ç–º–µ–Ω–µ–Ω–∞/–∑–∞–≤–µ—Ä—à–µ–Ω–∞ ‚Üí 400
       ‚îÇ
       ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∑–∞–ø–∏—Å–∏:           ‚îÇ
‚îÇ - status = "Cancelled"       ‚îÇ
‚îÇ - last_change_time = now()   ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
       ‚îÇ
       ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π         ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

**–ö–æ–¥**: `psychohelp/services/appointments.py::cancel_appointment_by_id`

**–ë–∏–∑–Ω–µ—Å-–ø—Ä–∞–≤–∏–ª–∞**:
1. –ù–µ–ª—å–∑—è –æ—Ç–º–µ–Ω–∏—Ç—å —É–∂–µ –æ—Ç–º–µ–Ω–µ–Ω–Ω—É—é –∑–∞–ø–∏—Å—å
2. –ù–µ–ª—å–∑—è –æ—Ç–º–µ–Ω–∏—Ç—å –∑–∞–≤–µ—Ä—à–µ–Ω–Ω—É—é –∑–∞–ø–∏—Å—å
3. –ü—Ä–∏ –æ—Ç–º–µ–Ω–µ –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è last_change_time
4. –ò—Å—Ç–æ—Ä–∏—è —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è (–∑–∞–ø–∏—Å—å –Ω–µ —É–¥–∞–ª—è–µ—Ç—Å—è)

---

### 4. üë®‚Äç‚öïÔ∏è –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–æ—Ñ–∏–ª—è–º–∏ –ø—Å–∏—Ö–æ–ª–æ–≥–æ–≤

#### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –ø—Å–∏—Ö–æ–ª–æ–≥–µ

–ü—Å–∏—Ö–æ–ª–æ–≥ - —ç—Ç–æ —Ä–∞—Å—à–∏—Ä–µ–Ω–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ —Å —Ä–æ–ª—å—é `Therapist`:

```
User (–±–∞–∑–æ–≤–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è)
‚îú‚îÄ‚îÄ –§–ò–û
‚îú‚îÄ‚îÄ –ö–æ–Ω—Ç–∞–∫—Ç—ã (email, —Ç–µ–ª–µ—Ñ–æ–Ω, —Å–æ—Ü—Å–µ—Ç–∏)
‚îî‚îÄ‚îÄ –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è

Therapist (–ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è)
‚îú‚îÄ‚îÄ –û–ø—ã—Ç —Ä–∞–±–æ—Ç—ã
‚îú‚îÄ‚îÄ –ö–≤–∞–ª–∏—Ñ–∏–∫–∞—Ü–∏—è
‚îú‚îÄ‚îÄ –û–±–ª–∞—Å—Ç–∏ –∫–æ–Ω—Å—É–ª—å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
‚îú‚îÄ‚îÄ –û–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ
‚îú‚îÄ‚îÄ –û–ø–∏—Å–∞–Ω–∏–µ
‚îú‚îÄ‚îÄ –ö—Ä–∞—Ç–∫–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ
‚îú‚îÄ‚îÄ –ù–æ–º–µ—Ä –∫–∞–±–∏–Ω–µ—Ç–∞
‚îî‚îÄ‚îÄ –§–æ—Ç–æ–≥—Ä–∞—Ñ–∏—è
```

**–ë–∏–∑–Ω–µ—Å-–ø—Ä–∞–≤–∏–ª–∞**:
1. –ü—Ä–æ—Ñ–∏–ª—å –ø—Å–∏—Ö–æ–ª–æ–≥–∞ —Å–æ–∑–¥–∞–µ—Ç—Å—è –æ—Ç–¥–µ–ª—å–Ω–æ –æ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
2. ID –ø—Å–∏—Ö–æ–ª–æ–≥–∞ = ID –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (One-to-One)
3. –¢–æ–ª—å–∫–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ —Å —Ä–æ–ª—å—é `Therapist` –º–æ–≥—É—Ç –∏–º–µ—Ç—å –ø—Ä–æ—Ñ–∏–ª—å
4. –§–æ—Ç–æ–≥—Ä–∞—Ñ–∏—è –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–∞

---

### 5. üìù –°–∏—Å—Ç–µ–º–∞ –æ—Ç–∑—ã–≤–æ–≤

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ –í—Å—Ç—Ä–µ—á–∞     ‚îÇ
‚îÇ –∑–∞–≤–µ—Ä—à–µ–Ω–∞   ‚îÇ
‚îÇ (Done)      ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
       ‚îÇ
       ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ –ü–∞—Ü–∏–µ–Ω—Ç –º–æ–∂–µ—Ç –æ—Å—Ç–∞–≤–∏—Ç—å –æ—Ç–∑—ã–≤ ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
       ‚îÇ
       ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ –°–æ–∑–¥–∞–Ω–∏–µ –æ—Ç–∑—ã–≤–∞:             ‚îÇ
‚îÇ - appointment_id (PK)        ‚îÇ
‚îÇ - time = now()               ‚îÇ
‚îÇ - content                    ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
       ‚îÇ
       ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ –ë–î              ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

**–ë–∏–∑–Ω–µ—Å-–ø—Ä–∞–≤–∏–ª–∞**:
1. **–û–¥–∏–Ω –æ—Ç–∑—ã–≤ –Ω–∞ –æ–¥–Ω—É –≤—Å—Ç—Ä–µ—á—É** (1:1 relationship)
2. –û—Ç–∑—ã–≤ –ø—Ä–∏–≤—è–∑–∞–Ω –∫ –≤—Å—Ç—Ä–µ—á–µ, –∞ –Ω–µ –∫ –ø—Å–∏—Ö–æ–ª–æ–≥—É –Ω–∞–ø—Ä—è–º—É—é
3. –ü—Ä–∏ —É–¥–∞–ª–µ–Ω–∏–∏ –≤—Å—Ç—Ä–µ—á–∏ –æ—Ç–∑—ã–≤ —É–¥–∞–ª—è–µ—Ç—Å—è (CASCADE)
4. –û—Ç–∑—ã–≤ –¥–æ–ª–∂–µ–Ω –æ—Å—Ç–∞–≤–ª—è—Ç—å—Å—è –ø–æ—Å–ª–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –≤—Å—Ç—Ä–µ—á–∏ (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –¥–æ–±–∞–≤–∏—Ç—å –ø—Ä–æ–≤–µ—Ä–∫—É)

---

### 6. üîê –°–∏—Å—Ç–µ–º–∞ —Ä–æ–ª–µ–π

#### –°—É—â–µ—Å—Ç–≤—É—é—â–∏–µ —Ä–æ–ª–∏

```python
class UserRole(enum.Enum):
    Therapist = "Therapist"          # –ü—Å–∏—Ö–æ–ª–æ–≥
    Administrator = "Administrator"  # –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä
```

#### –ú–æ–¥–µ–ª—å —Ä–æ–ª–µ–π

- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –º–æ–∂–µ—Ç –∏–º–µ—Ç—å **–Ω–µ—Å–∫–æ–ª—å–∫–æ —Ä–æ–ª–µ–π** –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ
- –†–æ–ª–∏ —Ö—Ä–∞–Ω—è—Ç—Å—è –≤ –æ—Ç–¥–µ–ª—å–Ω–æ–π —Ç–∞–±–ª–∏—Ü–µ (Many-to-Many —á–µ—Ä–µ–∑ –ø—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω—É—é —Ç–∞–±–ª–∏—Ü—É)
- Composite Primary Key: (user_id, role)

#### –ü—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞ (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è —Ä–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å)

| –†–æ–ª—å | –ü—Ä–∞–≤–∞ |
|------|-------|
| **–°—Ç—É–¥–µ–Ω—Ç** (–±–µ–∑ —Ä–æ–ª–µ–π) | –ü—Ä–æ—Å–º–æ—Ç—Ä –ø—Å–∏—Ö–æ–ª–æ–≥–æ–≤, —Å–æ–∑–¥–∞–Ω–∏–µ –∑–∞–ø–∏—Å–µ–π, –æ—Ç–º–µ–Ω–∞ —Å–≤–æ–∏—Ö –∑–∞–ø–∏—Å–µ–π, –æ—Å—Ç–∞–≤–ª–µ–Ω–∏–µ –æ—Ç–∑—ã–≤–æ–≤ |
| **Therapist** | –í—Å—ë —á—Ç–æ —Å—Ç—É–¥–µ–Ω—Ç + –ø—Ä–æ—Å–º–æ—Ç—Ä —Å–≤–æ–∏—Ö –∑–∞–ø–∏—Å–µ–π –∫–∞–∫ —Ç–µ—Ä–∞–ø–µ–≤—Ç–∞, –∏–∑–º–µ–Ω–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–∞ –≤—Å—Ç—Ä–µ—á |
| **Administrator** | –ü–æ–ª–Ω—ã–π –¥–æ—Å—Ç—É–ø –∫–æ –≤—Å–µ–º —Ñ—É–Ω–∫—Ü–∏—è–º, —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏, –º–æ–¥–µ—Ä–∞—Ü–∏—è |

**‚ö†Ô∏è –í–∞–∂–Ω–æ**: –í —Ç–µ–∫—É—â–µ–π —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –ø—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∞–≤ –Ω–µ –ø–æ–ª–Ω–æ—Å—Ç—å—é —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞. –†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –¥–æ–±–∞–≤–∏—Ç—å middleware –¥–ª—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏.

---

## –ë–∏–∑–Ω–µ—Å-–ø—Ä–∞–≤–∏–ª–∞ –∏ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è

### –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏

1. ‚úÖ Email –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å —É–Ω–∏–∫–∞–ª—å–Ω—ã–º
2. ‚úÖ –ü–∞—Ä–æ–ª—å –º–∏–Ω–∏–º—É–º 8 —Å–∏–º–≤–æ–ª–æ–≤
3. ‚úÖ –ü–∞—Ä–æ–ª—å –≤—Å–µ–≥–¥–∞ —Ö–µ—à–∏—Ä—É–µ—Ç—Å—è (bcrypt)
4. ‚úÖ –¢–µ–ª–µ—Ñ–æ–Ω –≤ –º–µ–∂–¥—É–Ω–∞—Ä–æ–¥–Ω–æ–º —Ñ–æ—Ä–º–∞—Ç–µ E164 (+79001234567)
5. ‚úÖ –û—Ç—á–µ—Å—Ç–≤–æ –∏ —Å–æ—Ü—Å–µ—Ç–∏ –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω—ã

### –ó–∞–ø–∏—Å–∏ –Ω–∞ –∫–æ–Ω—Å—É–ª—å—Ç–∞—Ü–∏–∏

1. ‚úÖ –ü–∞—Ü–∏–µ–Ω—Ç ‚â† –¢–µ—Ä–∞–ø–µ–≤—Ç (–Ω–µ–ª—å–∑—è –∑–∞–ø–∏—Å–∞—Ç—å—Å—è –∫ —Å–∞–º–æ–º—É —Å–µ–±–µ)
2. ‚úÖ –û–±–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –¥–æ–ª–∂–Ω—ã —Å—É—â–µ—Å—Ç–≤–æ–≤–∞—Ç—å
3. ‚úÖ –¢–∏–ø –≤—Å—Ç—Ä–µ—á–∏: —Ç–æ–ª—å–∫–æ Online –∏–ª–∏ Offline
4. ‚úÖ –°—Ç–∞—Ç—É—Å –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: Approved
5. ‚úÖ Venue –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è
6. ‚úÖ last_change_time –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è
7. ‚ö†Ô∏è –ù–µ—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏ –Ω–∞ –¥–≤–æ–π–Ω–æ–µ –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –æ–¥–Ω–æ–≥–æ –≤—Ä–µ–º–µ–Ω–∏
8. ‚ö†Ô∏è –ù–µ—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ –ø—Å–∏—Ö–æ–ª–æ–≥–∞

### –ü—Å–∏—Ö–æ–ª–æ–≥–∏

1. ‚úÖ ID –ø—Å–∏—Ö–æ–ª–æ–≥–∞ = ID –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
2. ‚úÖ –ü—Ä–∏ —É–¥–∞–ª–µ–Ω–∏–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –ø—Ä–æ—Ñ–∏–ª—å –ø—Å–∏—Ö–æ–ª–æ–≥–∞ —É–¥–∞–ª—è–µ—Ç—Å—è
3. ‚ö†Ô∏è –ù–µ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π –ø—Ä–æ–≤–µ—Ä–∫–∏ –Ω–∞–ª–∏—á–∏—è —Ä–æ–ª–∏ Therapist

### –û—Ç–∑—ã–≤—ã

1. ‚úÖ –û–¥–∏–Ω –æ—Ç–∑—ã–≤ –Ω–∞ –æ–¥–Ω—É –≤—Å—Ç—Ä–µ—á—É
2. ‚úÖ –ü—Ä–∏ —É–¥–∞–ª–µ–Ω–∏–∏ –≤—Å—Ç—Ä–µ—á–∏ –æ—Ç–∑—ã–≤ —É–¥–∞–ª—è–µ—Ç—Å—è
3. ‚ö†Ô∏è –ù–µ—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏, —á—Ç–æ –≤—Å—Ç—Ä–µ—á–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∞
4. ‚ö†Ô∏è –ù–µ—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏, —á—Ç–æ –æ—Ç–∑—ã–≤ –æ—Å—Ç–∞–≤–ª—è–µ—Ç –ø–∞—Ü–∏–µ–Ω—Ç

### –†–æ–ª–∏

1. ‚úÖ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –º–æ–∂–µ—Ç –∏–º–µ—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ —Ä–æ–ª–µ–π
2. ‚úÖ –ö–æ–º–ø–æ–∑–∏—Ç–Ω—ã–π –∫–ª—é—á (user_id, role) - —É–Ω–∏–∫–∞–ª—å–Ω–æ—Å—Ç—å
3. ‚ö†Ô∏è –ù–µ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø—Ä–∞–≤ –¥–æ—Å—Ç—É–ø–∞

---

## –í–∞–ª–∏–¥–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö

### –£—Ä–æ–≤–Ω–∏ –≤–∞–ª–∏–¥–∞—Ü–∏–∏

#### 1. Pydantic (Schemas)
- –§–æ—Ä–º–∞—Ç email
- –§–æ—Ä–º–∞—Ç —Ç–µ–ª–µ—Ñ–æ–Ω–∞ (E164)
- –î–ª–∏–Ω–∞ —Å—Ç—Ä–æ–∫
- –û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø–æ–ª—è
- –¢–∏–ø—ã –¥–∞–Ω–Ω—ã—Ö

**–ü—Ä–∏–º–µ—Ä**:
```python
class UserCreateRequest(BaseModel):
    first_name: str = Field(min_length=1, max_length=50)
    email: EmailStr
    phone_number: PhoneNumber
    password: str = Field(min_length=8, max_length=64)
```

#### 2. Service Layer
- –ë–∏–∑–Ω–µ—Å-–ø—Ä–∞–≤–∏–ª–∞
- –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏—è —Å–≤—è–∑–∞–Ω–Ω—ã—Ö –æ–±—ä–µ–∫—Ç–æ–≤
- –õ–æ–≥–∏—á–µ—Å–∫–∏–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è

**–ü—Ä–∏–º–µ—Ä**:
```python
if patient_id == therapist_id:
    raise ValueError("–ù–µ–ª—å–∑—è –∑–∞–ø–∏—Å–∞—Ç—å—Å—è –∫ —Å–∞–º–æ–º—É —Å–µ–±–µ")
```

#### 3. Database Layer
- –£–Ω–∏–∫–∞–ª—å–Ω–æ—Å—Ç—å
- Foreign Key constraints
- NOT NULL constraints
- CASCADE –ø—Ä–∞–≤–∏–ª–∞

---

## –¢—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ –∏ —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç—å –¥–∞–Ω–Ω—ã—Ö

### –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π

```python
async with get_async_db() as session:
    try:
        # –û–ø–µ—Ä–∞—Ü–∏–∏ —Å –ë–î
        await session.commit()
    except SQLAlchemyError:
        await session.rollback()
        raise
```

**–í–∞–∂–Ω–æ**:
- –í—Å–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ –≤ –æ–¥–Ω–æ–π —Å–µ—Å—Å–∏–∏ –≤—ã–ø–æ–ª–Ω—è—é—Ç—Å—è –∞—Ç–æ–º–∞—Ä–Ω–æ
- –ü—Ä–∏ –æ—à–∏–±–∫–µ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç rollback
- –¢—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ –æ–±–µ—Å–ø–µ—á–∏–≤–∞—é—Ç –∫–æ–Ω—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å –¥–∞–Ω–Ω—ã—Ö

### CASCADE —É–¥–∞–ª–µ–Ω–∏–µ

–ü—Ä–∏ —É–¥–∞–ª–µ–Ω–∏–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —É–¥–∞–ª—è—é—Ç—Å—è:
- –í—Å–µ –µ–≥–æ —Ä–æ–ª–∏
- –ü—Ä–æ—Ñ–∏–ª—å –ø—Å–∏—Ö–æ–ª–æ–≥–∞ (–µ—Å–ª–∏ –µ—Å—Ç—å)
- –í—Å–µ –≤—Å—Ç—Ä–µ—á–∏ (–∫–∞–∫ –ø–∞—Ü–∏–µ–Ω—Ç–∞ –∏ –∫–∞–∫ —Ç–µ—Ä–∞–ø–µ–≤—Ç–∞)
- –û—Ç–∑—ã–≤—ã –æ –µ–≥–æ –≤—Å—Ç—Ä–µ—á–∞—Ö

---

## –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

### –ó–∞—â–∏—Ç–∞ –ø–∞—Ä–æ–ª–µ–π

1. **–•–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ**: bcrypt —Å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π —Å–æ–ª—å—é
2. **–ù–∏–∫–æ–≥–¥–∞ –Ω–µ –≤–æ–∑–≤—Ä–∞—â–∞–µ–º**: –ø–∞—Ä–æ–ª—å –Ω–µ –≤–∫–ª—é—á–∞–µ—Ç—Å—è –≤ API –æ—Ç–≤–µ—Ç—ã
3. **–ü—Ä–æ–≤–µ—Ä–∫–∞**: —Ç–æ–ª—å–∫–æ —á–µ—Ä–µ–∑ bcrypt.verify()

### JWT —Ç–æ–∫–µ–Ω—ã

```python
{
  "sub": "user_id",           # Subject - ID –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
  "exp": 1697123456,          # Expiration time
  "iat": 1697037056           # Issued at
}
```

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã**:
- –ê–ª–≥–æ—Ä–∏—Ç–º: HS256 (HMAC-SHA256)
- Secret key: —Ö—Ä–∞–Ω–∏—Ç—Å—è –≤ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è
- TTL: –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç—Å—è —á–µ—Ä–µ–∑ ACCESS_TOKEN_EXPIRE

### HTTP-only Cookies

```python
response.set_cookie(
    key="access_token",
    value=token,
    httponly=True,      # –ó–∞—â–∏—Ç–∞ –æ—Ç XSS
    secure=True,        # –¢–æ–ª—å–∫–æ HTTPS (prod)
    samesite="None",    # CORS support
    expires=...
)
```

---

## –†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–µ —É–ª—É—á—à–µ–Ω–∏—è

### –ö—Ä–∏—Ç–∏—á–Ω—ã–µ

1. ‚úÖ **–ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∞–≤ –¥–æ—Å—Ç—É–ø–∞** - middleware –¥–ª—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
2. ‚úÖ **–ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞ –≤—Å—Ç—Ä–µ—á–∏** - –ø–µ—Ä–µ–¥ —Å–æ–∑–¥–∞–Ω–∏–µ–º –æ—Ç–∑—ã–≤–∞
3. ‚úÖ **–ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–≤–æ–π–Ω–æ–≥–æ –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è** - –æ–¥–∏–Ω –ø—Å–∏—Ö–æ–ª–æ–≥, –æ–¥–Ω–æ –≤—Ä–µ–º—è
4. ‚úÖ **Rate limiting** - –∑–∞—â–∏—Ç–∞ –æ—Ç —Å–ø–∞–º–∞ –∏ –∞—Ç–∞–∫

### –ñ–µ–ª–∞—Ç–µ–ª—å–Ω—ã–µ

1. üìß **Email —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è** - –æ —Å–æ–∑–¥–∞–Ω–∏–∏/–æ—Ç–º–µ–Ω–µ –∑–∞–ø–∏—Å–µ–π
2. üîî **Push —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è** - –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏—è –æ –≤—Å—Ç—Ä–µ—á–∞—Ö
3. üìä **–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ** - –∞—É–¥–∏—Ç –≤—Å–µ—Ö –¥–µ–π—Å—Ç–≤–∏–π
4. üîç **–ü–æ–∏—Å–∫ –∏ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è** - –ø—Å–∏—Ö–æ–ª–æ–≥–æ–≤ –ø–æ —Å–ø–µ—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏
5. ‚≠ê **–†–µ–π—Ç–∏–Ω–≥–∏** - —Å–∏—Å—Ç–µ–º–∞ –æ—Ü–µ–Ω–æ–∫ –ø—Å–∏—Ö–æ–ª–æ–≥–æ–≤

### –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ

1. üóÑÔ∏è **–ú–∏–≥—Ä–∞—Ü–∏–∏ –ë–î** - Alembic –¥–ª—è –≤–µ—Ä—Å–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è —Å—Ö–µ–º—ã
2. üîÑ **–ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ** - Redis –¥–ª—è —á–∞—Å—Ç–æ –∑–∞–ø—Ä–∞—à–∏–≤–∞–µ–º—ã—Ö –¥–∞–Ω–Ω—ã—Ö
3. üìà **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥** - –º–µ—Ç—Ä–∏–∫–∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
4. üß™ **–¢–µ—Å—Ç—ã** - –ø–æ–∫—Ä—ã—Ç–∏–µ –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∏ —Ç–µ—Å—Ç–∞–º–∏

# –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã —Å–∏—Å—Ç–µ–º—ã

## –û–±–∑–æ—Ä –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤

–°–∏—Å—Ç–µ–º–∞ —Å–æ—Å—Ç–æ–∏—Ç –∏–∑ —Å–ª–µ–¥—É—é—â–∏—Ö –æ—Å–Ω–æ–≤–Ω—ã—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤:

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ                   FastAPI App                   ‚îÇ
‚îÇ                  (main.py)                      ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
         ‚îÇ                           ‚îÇ
         ‚ñº                           ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê         ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  API Routers    ‚îÇ         ‚îÇ   Middleware        ‚îÇ
‚îÇ  (routes/)      ‚îÇ         ‚îÇ   (CORS, Auth)      ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò         ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
         ‚îÇ
         ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ             Controllers (routes/controllers/)    ‚îÇ
‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê ‚îÇ
‚îÇ  ‚îÇ  Users   ‚îÇ  Appts   ‚îÇTherapists‚îÇ Reviews  ‚îÇ ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
         ‚îÇ
         ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ             Services (services/)                 ‚îÇ
‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê ‚îÇ
‚îÇ  ‚îÇ  Users   ‚îÇ  Appts   ‚îÇTherapists‚îÇ Reviews  ‚îÇ ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
         ‚îÇ
         ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ           Repositories (repositories/)           ‚îÇ
‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê ‚îÇ
‚îÇ  ‚îÇ  Users   ‚îÇ  Appts   ‚îÇTherapists‚îÇ Reviews  ‚îÇ ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
         ‚îÇ
         ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ              Models (models/)                    ‚îÇ
‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê ‚îÇ
‚îÇ  ‚îÇ  User    ‚îÇAppointment‚îÇTherapist ‚îÇ Review   ‚îÇ ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
         ‚îÇ
         ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ              PostgreSQL Database                 ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

---

## 1. Main Application (main.py)

**–§–∞–π–ª**: `psychohelp/main.py`

**–û—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å**:
- –°–æ–∑–¥–∞–Ω–∏–µ –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ FastAPI –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
- –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ —Ä–æ—É—Ç–µ—Ä–æ–≤
- –ù–∞—Å—Ç—Ä–æ–π–∫–∞ CORS
- –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ë–î –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ

### –û—Å–Ω–æ–≤–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏

#### `get_application() -> FastAPI`
–°–æ–∑–¥–∞–µ—Ç –∏ –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç —ç–∫–∑–µ–º–ø–ª—è—Ä –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è.

**–ù–∞—Å—Ç—Ä–æ–π–∫–∏**:
```python
application = FastAPI()
application.include_router(api_router)

# CORS Configuration
application.add_middleware(
    CORSMiddleware,
    allow_origins=[...],
    allow_credentials=True,
    allow_methods=["*"],
    allow_headers=["*"],
)
```

#### `reset_database(engine: AsyncEngine)`
–£–¥–∞–ª—è–µ—Ç –∏ –ø–µ—Ä–µ—Å–æ–∑–¥–∞–µ—Ç –≤—Å–µ —Ç–∞–±–ª–∏—Ü—ã –ë–î.

**‚ö†Ô∏è –í–Ω–∏–º–∞–Ω–∏–µ**: –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏!

```python
async def reset_database(engine: AsyncEngine):
    async with engine.begin() as conn:
        await conn.run_sync(Base.metadata.drop_all)
        await conn.run_sync(Base.metadata.create_all)
```

#### Startup Event
```python
@application.on_event("startup")
async def on_startup():
    if RESET_DB_ON_START:
        await reset_database(engine)
```

---

## 2. Configuration (config/)

### database.py

**–§–∞–π–ª**: `psychohelp/config/database.py`

**–û—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å**:
- –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ –ë–î
- –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–µ—Å—Å–∏—è–º–∏
- –°–æ–∑–¥–∞–Ω–∏–µ Base –¥–ª—è ORM –º–æ–¥–µ–ª–µ–π

#### Config Class
```python
class Config:
    POSTGRES_USER = os.getenv("POSTGRES_USER", "myuser")
    POSTGRES_PASSWORD = os.getenv("POSTGRES_PASSWORD", "mypassword")
    POSTGRES_DB = os.getenv("POSTGRES_DB", "mydatabase")
    POSTGRES_HOST = os.getenv("POSTGRES_HOST", "localhost")
    POSTGRES_PORT = os.getenv("POSTGRES_PORT", "5432")
    
    DATABASE_URL = f"postgresql+asyncpg://{POSTGRES_USER}:..."
```

#### Async Session Manager
```python
@asynccontextmanager
async def get_async_db():
    session: AsyncSession = async_session()
    try:
        yield session
    except exc.SQLAlchemyError:
        await session.rollback()
        raise
    finally:
        await session.close()
```

**–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ**:
```python
async with get_async_db() as session:
    result = await session.execute(query)
```

---

## 3. Models (models/)

ORM –º–æ–¥–µ–ª–∏, –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è—é—â–∏–µ —Ç–∞–±–ª–∏—Ü—ã –ë–î.

### users.py

**–ö–ª–∞—Å—Å**: `User`

**–û–ø–∏—Å–∞–Ω–∏–µ**: –ë–∞–∑–æ–≤–∞—è –º–æ–¥–µ–ª—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

**–ö–ª—é—á–µ–≤—ã–µ –ø–æ–ª—è**:
- `id`: UUID (Primary Key)
- `first_name`, `middle_name`, `last_name`: –§–ò–û –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- `email`: –£–Ω–∏–∫–∞–ª—å–Ω—ã–π email –¥–ª—è –≤—Ö–æ–¥–∞
- `phone_number`: –¢–µ–ª–µ—Ñ–æ–Ω –≤ —Ñ–æ—Ä–º–∞—Ç–µ E164
- `password`: –•–µ—à–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –ø–∞—Ä–æ–ª—å (bcrypt)
- `social_media`: –°—Å—ã–ª–∫–∏ –Ω–∞ —Å–æ—Ü—Å–µ—Ç–∏ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

**Relationships**:
```python
roles = relationship("Role", back_populates="user")
appointments_as_patient = relationship("Appointment", foreign_keys="[Appointment.patient_id]")
appointments_as_therapist = relationship("Appointment", foreign_keys="[Appointment.therapist_id]")
therapist_info = relationship("Therapist", uselist=False)  # One-to-One
```

---

### therapists.py

**–ö–ª–∞—Å—Å**: `Therapist`

**–û–ø–∏—Å–∞–Ω–∏–µ**: –†–∞—Å—à–∏—Ä–µ–Ω–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –ø—Å–∏—Ö–æ–ª–æ–≥–∞—Ö

**–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏**:
- `id` - Foreign Key –∫ `users.id` –∏ Primary Key –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ
- One-to-One relationship —Å User
- CASCADE —É–¥–∞–ª–µ–Ω–∏–µ –ø—Ä–∏ —É–¥–∞–ª–µ–Ω–∏–∏ User

**–ö–ª—é—á–µ–≤—ã–µ –ø–æ–ª—è**:
- `experience`: –û–ø—ã—Ç —Ä–∞–±–æ—Ç—ã
- `qualification`: –ö–≤–∞–ª–∏—Ñ–∏–∫–∞—Ü–∏—è –∏ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã
- `consult_areas`: –û–±–ª–∞—Å—Ç–∏ –∫–æ–Ω—Å—É–ª—å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
- `education`: –û–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ
- `office`: –ù–æ–º–µ—Ä –∫–∞–±–∏–Ω–µ—Ç–∞
- `description`: –ü–æ–ª–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ
- `short_description`: –ö—Ä–∞—Ç–∫–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ
- `photo`: –ü—É—Ç—å –∫ —Ñ–æ—Ç–æ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

**Relationships**:
```python
user = relationship("User", back_populates="therapist_info")
```

---

### appointments.py

**–ö–ª–∞—Å—Å**: `Appointment`

**–û–ø–∏—Å–∞–Ω–∏–µ**: –ó–∞–ø–∏—Å–∏ –Ω–∞ –∫–æ–Ω—Å—É–ª—å—Ç–∞—Ü–∏–∏

**Enum Types**:
```python
class AppointmentType(enum.Enum):
    Offline = "Offline"  # –û—á–Ω–∞—è –≤—Å—Ç—Ä–µ—á–∞
    Online = "Online"    # –û–Ω–ª–∞–π–Ω-–∫–æ–Ω—Å—É–ª—å—Ç–∞—Ü–∏—è

class AppointmentStatus(enum.Enum):
    Approved = "Approved"    # –û–¥–æ–±—Ä–µ–Ω–∞ (—Å–æ–∑–¥–∞–Ω–∞)
    Accepted = "Accepted"    # –ü—Ä–∏–Ω—è—Ç–∞ –ø—Å–∏—Ö–æ–ª–æ–≥–æ–º
    Cancelled = "Cancelled"  # –û—Ç–º–µ–Ω–µ–Ω–∞
    Done = "Done"            # –ó–∞–≤–µ—Ä—à–µ–Ω–∞
```

**–ö–ª—é—á–µ–≤—ã–µ –ø–æ–ª—è**:
- `id`: UUID (Primary Key)
- `patient_id`, `therapist_id`: Foreign Keys –∫ users
- `type`: –¢–∏–ø –≤—Å—Ç—Ä–µ—á–∏ (Online/Offline)
- `status`: –°—Ç–∞—Ç—É—Å –∑–∞–ø–∏—Å–∏
- `reason`: –ü—Ä–∏—á–∏–Ω–∞ –æ–±—Ä–∞—â–µ–Ω–∏—è (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
- `remind_time`: –í—Ä–µ–º—è –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏—è (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
- `last_change_time`: –í—Ä–µ–º—è –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –∏–∑–º–µ–Ω–µ–Ω–∏—è
- `venue`: –ú–µ—Å—Ç–æ –≤—Å—Ç—Ä–µ—á–∏ (–∫–∞–±–∏–Ω–µ—Ç/—Å—Å—ã–ª–∫–∞)

**Relationships**:
```python
patient = relationship("User", foreign_keys=[patient_id], back_populates="appointments_as_patient")
therapist = relationship("User", foreign_keys=[therapist_id], back_populates="appointments_as_therapist")
review = relationship("Review", uselist=False)  # One-to-One
```

**–ö–∞—Å–∫–∞–¥–Ω–æ–µ —É–¥–∞–ª–µ–Ω–∏–µ**: –ü—Ä–∏ —É–¥–∞–ª–µ–Ω–∏–∏ User —É–¥–∞–ª—è—é—Ç—Å—è –≤—Å–µ –µ–≥–æ –∑–∞–ø–∏—Å–∏ (–∫–∞–∫ –ø–∞—Ü–∏–µ–Ω—Ç–∞ –∏ –∫–∞–∫ —Ç–µ—Ä–∞–ø–µ–≤—Ç–∞)

---

### reviews.py

**–ö–ª–∞—Å—Å**: `Review`

**–û–ø–∏—Å–∞–Ω–∏–µ**: –û—Ç–∑—ã–≤—ã –æ –∫–æ–Ω—Å—É–ª—å—Ç–∞—Ü–∏—è—Ö

**–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏**:
- `appointment_id` –∫–∞–∫ Primary Key
- One-to-One —Å Appointment
- CASCADE —É–¥–∞–ª–µ–Ω–∏–µ –ø—Ä–∏ —É–¥–∞–ª–µ–Ω–∏–∏ Appointment

**–ö–ª—é—á–µ–≤—ã–µ –ø–æ–ª—è**:
- `appointment_id`: UUID (Primary Key, Foreign Key –∫ appointments)
- `time`: –í—Ä–µ–º—è —Å–æ–∑–¥–∞–Ω–∏—è –æ—Ç–∑—ã–≤–∞
- `content`: –°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ –æ—Ç–∑—ã–≤–∞

**Relationships**:
```python
appointment = relationship("Appointment", back_populates="review")
```

---

### roles.py

**–ö–ª–∞—Å—Å**: `Role`

**–û–ø–∏—Å–∞–Ω–∏–µ**: –†–æ–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π

**Enum Type**:
```python
class UserRole(enum.Enum):
    Therapist = "Therapist"          # –ü—Å–∏—Ö–æ–ª–æ–≥
    Administrator = "Administrator"  # –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä
```

**–ö–ª—é—á–µ–≤—ã–µ –ø–æ–ª—è**:
- `user_id`: UUID (—á–∞—Å—Ç—å —Å–æ—Å—Ç–∞–≤–Ω–æ–≥–æ Primary Key, Foreign Key –∫ users)
- `role`: Enum (—á–∞—Å—Ç—å —Å–æ—Å—Ç–∞–≤–Ω–æ–≥–æ Primary Key)

**–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏**:
- Composite Primary Key: (user_id, role)
- –û–¥–∏–Ω –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –º–æ–∂–µ—Ç –∏–º–µ—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ —Ä–æ–ª–µ–π
- Many-to-Many relationship —á–µ—Ä–µ–∑ —ç—Ç—É —Ç–∞–±–ª–∏—Ü—É
- CASCADE —É–¥–∞–ª–µ–Ω–∏–µ –ø—Ä–∏ —É–¥–∞–ª–µ–Ω–∏–∏ User

**Relationships**:
```python
user = relationship("User", back_populates="roles")
```

---

## 4. Repositories (repositories/)

–°–ª–æ–π –¥–æ—Å—Ç—É–ø–∞ –∫ –¥–∞–Ω–Ω—ã–º. –í—Å–µ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è —Å –ë–î –∏–Ω–∫–∞–ø—Å—É–ª–∏—Ä–æ–≤–∞–Ω—ã –∑–¥–µ—Å—å.

### –û–±—â–∏–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã

#### CRUD –æ–ø–µ—Ä–∞—Ü–∏–∏
–ö–∞–∂–¥—ã–π —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π —Ä–µ–∞–ª–∏–∑—É–µ—Ç –±–∞–∑–æ–≤—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏:
- `create_*` - —Å–æ–∑–¥–∞–Ω–∏–µ
- `get_*_by_id` - –ø–æ–ª—É—á–µ–Ω–∏–µ –ø–æ ID
- `get_*_by_*` - –ø–æ–ª—É—á–µ–Ω–∏–µ –ø–æ –¥—Ä—É–≥–∏–º –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º
- `update_*` - –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ
- `delete_*` - —É–¥–∞–ª–µ–Ω–∏–µ

#### –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ AsyncSession
```python
async with get_async_db() as session:
    result = await session.execute(
        select(User).where(User.email == email)
    )
    user = result.scalar_one_or_none()
    return user
```

---

### repositories/__init__.py

**–£—Ç–∏–ª–∏—Ç—ã –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏**:

#### `create_access_token(sub: str) -> str`
–°–æ–∑–¥–∞–µ—Ç JWT —Ç–æ–∫–µ–Ω.

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã**:
- `sub`: User ID (subject)
- `exp`: –í—Ä–µ–º—è –∏—Å—Ç–µ—á–µ–Ω–∏—è
- `iat`: –í—Ä–µ–º—è –≤—ã–¥–∞—á–∏

```python
encoded = jwt.encode(
    {"sub": str(sub), "exp": expire, "iat": now},
    SECRET_KEY,
    algorithm=ALGORITHM,
)
```

#### `get_user_id_from_token(token: str) -> UUID`
–î–µ–∫–æ–¥–∏—Ä—É–µ—Ç —Ç–æ–∫–µ–Ω –∏ –∏–∑–≤–ª–µ–∫–∞–µ—Ç User ID.

**–ü—Ä–æ–≤–µ—Ä–∫–∏**:
- –ü–æ–¥–ø–∏—Å—å
- –í—Ä–µ–º—è –∏—Å—Ç–µ—á–µ–Ω–∏—è
- –í—Ä–µ–º—è –≤—ã–¥–∞—á–∏

#### `hash_password(password: str) -> str`
–•–µ—à–∏—Ä—É–µ—Ç –ø–∞—Ä–æ–ª—å —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º bcrypt.

#### `verify_password(plain: str, hashed: str) -> bool`
–ü—Ä–æ–≤–µ—Ä—è–µ—Ç –ø–∞—Ä–æ–ª—å.

---

### repositories/users.py

**–û—Å–Ω–æ–≤–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏**:

#### `create_user(...) -> User`
–°–æ–∑–¥–∞–µ—Ç –Ω–æ–≤–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.

**–í–∞–ª–∏–¥–∞—Ü–∏—è**:
- –ü—Ä–æ–≤–µ—Ä–∫–∞ —É–Ω–∏–∫–∞–ª—å–Ω–æ—Å—Ç–∏ email
- –•–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–∞—Ä–æ–ª—è –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å –≤—ã–ø–æ–ª–Ω–µ–Ω–æ –¥–æ –≤—ã–∑–æ–≤–∞

#### `get_user_by_id(user_id: UUID) -> User | None`
–ü–æ–ª—É—á–∞–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –ø–æ ID.

#### `get_user_by_email(email: str) -> User | None`
–ü–æ–ª—É—á–∞–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –ø–æ email.

#### `get_user_by_token(token: str) -> User | None`
–ü–æ–ª—É—á–∞–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –ø–æ JWT —Ç–æ–∫–µ–Ω—É.

**–ü—Ä–æ—Ü–µ—Å—Å**:
1. –î–µ–∫–æ–¥–∏—Ä—É–µ—Ç —Ç–æ–∫–µ–Ω
2. –ò–∑–≤–ª–µ–∫–∞–µ—Ç user_id
3. –ó–∞–≥—Ä—É–∂–∞–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏–∑ –ë–î

---

### repositories/appointments.py

**–û—Å–Ω–æ–≤–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏**:

#### `create_appointment(...) -> Appointment`
–°–æ–∑–¥–∞–µ—Ç –Ω–æ–≤—É—é –∑–∞–ø–∏—Å—å.

**–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –ø–æ–ª—è**:
- `id`: –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç—Å—è UUID
- `status`: —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è "Approved"
- `last_change_time`: —Ç–µ–∫—É—â–µ–µ –≤—Ä–µ–º—è

#### `get_appointment_by_id(id: UUID) -> Appointment | None`
–ü–æ–ª—É—á–∞–µ—Ç –∑–∞–ø–∏—Å—å –ø–æ ID.

#### `get_appointments_by_user_id(user_id: UUID) -> list[Appointment]`
–ü–æ–ª—É—á–∞–µ—Ç –≤—Å–µ –∑–∞–ø–∏—Å–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (–∫–∞–∫ –ø–∞—Ü–∏–µ–Ω—Ç –∏ –∫–∞–∫ —Ç–µ—Ä–∞–ø–µ–≤—Ç).

**–ó–∞–ø—Ä–æ—Å**:
```python
appointments = await session.execute(
    select(Appointment).where(
        (Appointment.patient_id == user_id) | 
        (Appointment.therapist_id == user_id)
    )
)
```

#### `cancel_appointment(id: UUID) -> None`
–û—Ç–º–µ–Ω—è–µ—Ç –∑–∞–ø–∏—Å—å.

**–î–µ–π—Å—Ç–≤–∏—è**:
1. –ù–∞—Ö–æ–¥–∏—Ç –∑–∞–ø–∏—Å—å
2. –ü—Ä–æ–≤–µ—Ä—è–µ—Ç —Å—Ç–∞—Ç—É—Å
3. –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç status = "Cancelled"
4. –û–±–Ω–æ–≤–ª—è–µ—Ç last_change_time

---

### repositories/therapists.py

**–û—Å–Ω–æ–≤–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏**:

#### `get_therapist_by_id(id: UUID) -> Therapist | None`
–ü–æ–ª—É—á–∞–µ—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –ø—Å–∏—Ö–æ–ª–æ–≥–µ.

#### `get_all_therapists() -> list[Therapist]`
–ü–æ–ª—É—á–∞–µ—Ç —Å–ø–∏—Å–æ–∫ –≤—Å–µ—Ö –ø—Å–∏—Ö–æ–ª–æ–≥–æ–≤.

**–ú–æ–∂–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è —Å**:
- –§–∏–ª—å—Ç—Ä–∞—Ü–∏–µ–π
- –ü–∞–≥–∏–Ω–∞—Ü–∏–µ–π (–±—É–¥—É—â–µ–µ —É–ª—É—á—à–µ–Ω–∏–µ)
- –°–æ—Ä—Ç–∏—Ä–æ–≤–∫–æ–π

---

### repositories/reviews.py

**–û—Å–Ω–æ–≤–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏**:

#### `get_review_by_appointment_id(id: UUID) -> Review | None`
–ü–æ–ª—É—á–∞–µ—Ç –æ—Ç–∑—ã–≤ –æ –≤—Å—Ç—Ä–µ—á–µ.

---

### repositories/roles.py

**–û—Å–Ω–æ–≤–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏**:

#### `get_roles_by_user_id(user_id: UUID) -> list[Role]`
–ü–æ–ª—É—á–∞–µ—Ç –≤—Å–µ —Ä–æ–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.

---

## 5. Services (services/)

–ë–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è. –ö–æ–æ—Ä–¥–∏–Ω–∏—Ä—É–µ—Ç —Ä–∞–±–æ—Ç—É —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–µ–≤ –∏ –ø—Ä–∏–º–µ–Ω—è–µ—Ç –±–∏–∑–Ω–µ—Å-–ø—Ä–∞–≤–∏–ª–∞.

### –ü–∞—Ç—Ç–µ—Ä–Ω –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

```
Controller ‚Üí Service ‚Üí Repository ‚Üí Database
```

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞**:
- –†–∞–∑–¥–µ–ª–µ–Ω–∏–µ –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç–∏
- –ü–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –ª–æ–≥–∏–∫–∏
- –£–ø—Ä–æ—â–µ–Ω–∏–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
- –õ–µ–≥–∫–æ—Å—Ç—å –¥–æ–±–∞–≤–ª–µ–Ω–∏—è —Å–ª–æ–∂–Ω–æ–π –ª–æ–≥–∏–∫–∏

---

### services/users.py

**–û—Å–Ω–æ–≤–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏**:

#### `register_user(...) -> tuple[User, str]`
–†–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–µ—Ç –Ω–æ–≤–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.

**–ü—Ä–æ—Ü–µ—Å—Å**:
1. –•–µ—à–∏—Ä—É–µ—Ç –ø–∞—Ä–æ–ª—å
2. –°–æ–∑–¥–∞–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è —á–µ—Ä–µ–∑ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π
3. –ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç JWT —Ç–æ–∫–µ–Ω
4. –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç (user, token)

**–ë–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞**:
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–∞—Ä–æ–ª—è
- –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Ç–æ–∫–µ–Ω–∞ –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏

#### `login_user(email: str, password: str) -> tuple[User, str] | None`
–ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏—Ü–∏—Ä—É–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.

**–ü—Ä–æ—Ü–µ—Å—Å**:
1. –ü–æ–ª—É—á–∞–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –ø–æ email
2. –ü—Ä–æ–≤–µ—Ä—è–µ—Ç –ø–∞—Ä–æ–ª—å
3. –ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç —Ç–æ–∫–µ–Ω
4. –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç (user, token) –∏–ª–∏ None

**–ë–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞**:
- –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–∞—Ä–æ–ª—è —á–µ—Ä–µ–∑ bcrypt
- –í–æ–∑–≤—Ä–∞—Ç None –ø—Ä–∏ –Ω–µ–≤–µ—Ä–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö

#### `get_user_by_*(...) -> User | None`
–ü—Ä–æ–∫—Å–∏-—Ñ—É–Ω–∫—Ü–∏–∏ –∫ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—é.

**–¶–µ–ª—å**: –ï–¥–∏–Ω–∞—è —Ç–æ—á–∫–∞ –¥–æ—Å—Ç—É–ø–∞ –∫ –¥–∞–Ω–Ω—ã–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π

---

### services/appointments.py

**–û—Å–Ω–æ–≤–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏**:

#### `create_appointment(...) -> Appointment`
–°–æ–∑–¥–∞–µ—Ç –Ω–æ–≤—É—é –∑–∞–ø–∏—Å—å.

**–ë–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞**:
1. –ü—Ä–æ–≤–µ—Ä—è–µ—Ç, —á—Ç–æ –ø–∞—Ü–∏–µ–Ω—Ç ‚â† —Ç–µ—Ä–∞–ø–µ–≤—Ç
2. –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç —Å—Ç–∞—Ç—É—Å "Approved"
3. –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç —Ç–µ–∫—É—â–µ–µ –≤—Ä–µ–º—è –≤ last_change_time
4. –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç venue (–µ—Å–ª–∏ –Ω–µ —É–∫–∞–∑–∞–Ω–æ)

**–í–∞–ª–∏–¥–∞—Ü–∏—è**:
```python
if patient_id == therapist_id:
    raise ValueError("–ü–∞—Ü–∏–µ–Ω—Ç –Ω–µ –º–æ–∂–µ—Ç –±—ã—Ç—å —Ç–µ—Ä–∞–ø–µ–≤—Ç–æ–º")
```

#### `cancel_appointment_by_id(id: UUID) -> None`
–û—Ç–º–µ–Ω—è–µ—Ç –∑–∞–ø–∏—Å—å.

**–ë–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞**:
1. –ü—Ä–æ–≤–µ—Ä—è–µ—Ç —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏–µ –∑–∞–ø–∏—Å–∏
2. –ü—Ä–æ–≤–µ—Ä—è–µ—Ç, —á—Ç–æ —Å—Ç–∞—Ç—É—Å –Ω–µ "Cancelled" –∏–ª–∏ "Done"
3. –û–±–Ω–æ–≤–ª—è–µ—Ç —Å—Ç–∞—Ç—É—Å –∏ –≤—Ä–µ–º—è

#### `get_appointments_by_token(token: str) -> list[Appointment]`
–ü–æ–ª—É—á–∞–µ—Ç –∑–∞–ø–∏—Å–∏ —Ç–µ–∫—É—â–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.

**–ü—Ä–æ—Ü–µ—Å—Å**:
1. –î–µ–∫–æ–¥–∏—Ä—É–µ—Ç —Ç–æ–∫–µ–Ω
2. –ò–∑–≤–ª–µ–∫–∞–µ—Ç user_id
3. –ü–æ–ª—É—á–∞–µ—Ç –≤—Å–µ –∑–∞–ø–∏—Å–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

---

### services/therapists.py

**–û—Å–Ω–æ–≤–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏**:

#### `get_therapist_by_id(id: UUID) -> Therapist | None`
–ü–æ–ª—É—á–∞–µ—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –ø—Å–∏—Ö–æ–ª–æ–≥–µ.

#### `get_all_therapists() -> list[Therapist]`
–ü–æ–ª—É—á–∞–µ—Ç —Å–ø–∏—Å–æ–∫ –≤—Å–µ—Ö –ø—Å–∏—Ö–æ–ª–æ–≥–æ–≤.

**–í–æ–∑–º–æ–∂–Ω—ã–µ —É–ª—É—á—à–µ–Ω–∏—è**:
- –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
- –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ —Å–ø–µ—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏
- –°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ –ø–æ —Ä–µ–π—Ç–∏–Ω–≥—É

---

### services/reviews.py

**–û—Å–Ω–æ–≤–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏**:

#### `get_review_by_appointment_id(id: UUID) -> Review | None`
–ü–æ–ª—É—á–∞–µ—Ç –æ—Ç–∑—ã–≤ –æ –≤—Å—Ç—Ä–µ—á–µ.

---

### services/roles.py

**–û—Å–Ω–æ–≤–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏**:

#### `get_roles_by_user_id(user_id: UUID) -> list[Role]`
–ü–æ–ª—É—á–∞–µ—Ç —Ä–æ–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.

---

## 6. Routes/Controllers (routes/controllers/)

API endpoints. –û–±—Ä–∞–±–∞—Ç—ã–≤–∞—é—Ç HTTP –∑–∞–ø—Ä–æ—Å—ã –∏ —Ñ–æ—Ä–º–∏—Ä—É—é—Ç –æ—Ç–≤–µ—Ç—ã.

### –û–±—â–∏–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã

#### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä–∞
```python
router = APIRouter(prefix="/resource", tags=["resource"])

@router.get("/{id}")
async def get_resource(id: UUID):
    resource = await service.get_resource(id)
    if not resource:
        raise HTTPException(404, detail="Not found")
    return resource
```

#### –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫
```python
try:
    result = await service.create_resource(...)
except ValueError as e:
    raise HTTPException(400, detail=str(e))
```

---

### routes/controllers/__init__.py

**–£—Ç–∏–ª–∏—Ç—ã**:

#### `set_token_in_cookie(response: Response, token: str)`
–£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç JWT —Ç–æ–∫–µ–Ω –≤ HTTP-only cookie.

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã cookie**:
```python
response.set_cookie(
    key="access_token",
    value=token,
    expires=...,
    httponly=True,
    secure=True,
    samesite="None",
)
```

---

### routes/controllers/users.py

**Router**: `/users`

**Endpoints**:
- `GET /user` - –¢–µ–∫—É—â–∏–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å
- `GET /user/{id}` - –ü–æ ID –∏–ª–∏ email
- `POST /register` - –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è
- `POST /login` - –í—Ö–æ–¥
- `POST /logout` - –í—ã—Ö–æ–¥

**–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏**:
- Cookie-based authentication
- –í–∞–ª–∏–¥–∞—Ü–∏—è —á–µ—Ä–µ–∑ Pydantic
- –†–∞–∑–¥–µ–ª–µ–Ω–∏–µ –ø—É–±–ª–∏—á–Ω—ã—Ö –∏ –∑–∞—â–∏—â–µ–Ω–Ω—ã—Ö endpoints

---

### routes/controllers/appointments.py

**Router**: `/appointments`

**Endpoints**:
- `GET /` - –í—Å–µ –∑–∞–ø–∏—Å–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- `GET /{id}` - –ü–æ ID
- `POST /create` - –°–æ–∑–¥–∞–Ω–∏–µ
- `PUT /{id}/cancel` - –û—Ç–º–µ–Ω–∞

**–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏**:
- –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–∞—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è –Ω–∞ –Ω–µ–∫–æ—Ç–æ—Ä—ã—Ö endpoints
- Query –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –¥–ª—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏

---

### routes/controllers/therapists.py

**Router**: `/therapists`

**Endpoints**:
- `GET /` - –í—Å–µ –ø—Å–∏—Ö–æ–ª–æ–≥–∏
- `GET /{id}` - –ü–æ ID

---

### routes/controllers/reviews.py

**Router**: `/reviews`

**Endpoints**:
- `GET /{appointment_id}` - –û—Ç–∑—ã–≤ –æ –≤—Å—Ç—Ä–µ—á–µ

---

### routes/controllers/roles.py

**Router**: `/roles`

**Endpoints**:
- `GET /{user_id}` - –†–æ–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

---

### routes/controllers/images.py

**Router**: `/images`

**Endpoints**:
- `POST /upload` - –ó–∞–≥—Ä—É–∑–∫–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
- `GET /{filename}` - –ü–æ–ª—É—á–µ–Ω–∏–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è

**–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏**:
- –†–∞–±–æ—Ç–∞ —Å multipart/form-data
- –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Ñ–∞–π–ª–æ–≤ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ

---

## 7. Schemas (schemas/)

Pydantic –º–æ–¥–µ–ª–∏ –¥–ª—è –≤–∞–ª–∏–¥–∞—Ü–∏–∏ –∏ —Å–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏–∏.

### –¢–∏–ø—ã —Å—Ö–µ–º

#### Request Schemas
–î–ª—è –≤—Ö–æ–¥—è—â–∏—Ö –¥–∞–Ω–Ω—ã—Ö (POST/PUT).

**–ü—Ä–∏–º–µ—Ä**:
```python
class UserCreateRequest(BaseModel):
    first_name: str = Field(min_length=1, max_length=50)
    email: EmailStr
    password: str = Field(min_length=8)
```

#### Response Schemas
–î–ª—è –∏—Å—Ö–æ–¥—è—â–∏—Ö –¥–∞–Ω–Ω—ã—Ö (GET).

**–ü—Ä–∏–º–µ—Ä**:
```python
class UserResponse(BaseModel):
    id: UUID
    first_name: str
    email: EmailStr
    
    class Config:
        from_attributes = True  # –î–ª—è ORM –º–æ–¥–µ–ª–µ–π
```

#### Base Schemas
–ü–æ–ª–Ω—ã–µ –º–æ–¥–µ–ª–∏ —Å –≤—Å–µ–º–∏ –ø–æ–ª—è–º–∏.

---

### schemas/users.py

**–ú–æ–¥–µ–ª–∏**:
- `UserCreateRequest` - –î–ª—è —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏
- `UserResponse` - –î–ª—è –æ—Ç–≤–µ—Ç–æ–≤ (–±–µ–∑ –ø–∞—Ä–æ–ª—è)
- `LoginRequest` - –î–ª—è –≤—Ö–æ–¥–∞
- `TokenResponse` - –û—Ç–≤–µ—Ç —Å —Ç–æ–∫–µ–Ω–æ–º

**–í–∞–ª–∏–¥–∞—Ç–æ—Ä—ã**:
- `EmailStr` - Pydantic email validator
- `PhoneNumber` - –ö–∞—Å—Ç–æ–º–Ω—ã–π –≤–∞–ª–∏–¥–∞—Ç–æ—Ä –¥–ª—è E164 —Ñ–æ—Ä–º–∞—Ç–∞

---

### schemas/appointments.py

**–ú–æ–¥–µ–ª–∏**:
- `AppointmentCreateRequest` - –î–ª—è —Å–æ–∑–¥–∞–Ω–∏—è
- `AppointmentBase` - –ü–æ–ª–Ω–∞—è –º–æ–¥–µ–ª—å

**Enum –∏–º–ø–æ—Ä—Ç—ã**:
```python
from psychohelp.repositories.appointments import (
    AppointmentType,
    AppointmentStatus,
)
```

---

## 8. Tests (tests/)

–¢–µ—Å—Ç—ã –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏.

### conftest.py

**–§–∏–∫—Å—Ç—É—Ä—ã**:
- –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Ç–µ—Å—Ç–æ–≤–æ–π –ë–î
- –°–æ–∑–¥–∞–Ω–∏–µ —Ç–µ—Å—Ç–æ–≤–æ–≥–æ –∫–ª–∏–µ–Ω—Ç–∞
- –ú–æ–∫–∏ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π

### test_users.py

–¢–µ—Å—Ç—ã –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏—Ö –æ–ø–µ—Ä–∞—Ü–∏–π:
- –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è
- –í—Ö–æ–¥
- –ü–æ–ª—É—á–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö

---

## –í–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤

### –ü—Ä–∏–º–µ—Ä: –°–æ–∑–¥–∞–Ω–∏–µ –∑–∞–ø–∏—Å–∏

```
1. HTTP Request
   POST /appointments/create
   Body: {patient_id, therapist_id, ...}

2. Controller (routes/controllers/appointments.py)
   - –ü–æ–ª—É—á–∞–µ—Ç Request Body
   - –í–∞–ª–∏–¥–∏—Ä—É–µ—Ç —á–µ—Ä–µ–∑ AppointmentCreateRequest
   - –í—ã–∑—ã–≤–∞–µ—Ç service.create_appointment()

3. Service (services/appointments.py)
   - –ü—Ä–∏–º–µ–Ω—è–µ—Ç –±–∏–∑–Ω–µ—Å-–ø—Ä–∞–≤–∏–ª–∞
   - –ü—Ä–æ–≤–µ—Ä—è–µ—Ç patient_id ‚â† therapist_id
   - –í—ã–∑—ã–≤–∞–µ—Ç repository.create_appointment()

4. Repository (repositories/appointments.py)
   - –°–æ–∑–¥–∞–µ—Ç –æ–±—ä–µ–∫—Ç Appointment
   - –°–æ—Ö—Ä–∞–Ω—è–µ—Ç –≤ –ë–î —á–µ—Ä–µ–∑ SQLAlchemy
   - –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Å–æ–∑–¥–∞–Ω–Ω—ã–π –æ–±—ä–µ–∫—Ç

5. Service
   - –ü–æ–ª—É—á–∞–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç
   - –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç –≤ Controller

6. Controller
   - –°–µ—Ä–∏–∞–ª–∏–∑—É–µ—Ç —á–µ—Ä–µ–∑ AppointmentBase
   - –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç HTTP Response
```

---

## –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –∏ –æ–∫—Ä—É–∂–µ–Ω–∏–µ

### –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è

```bash
# Database
POSTGRES_USER=myuser
POSTGRES_PASSWORD=mypassword
POSTGRES_DB=mydatabase
POSTGRES_HOST=localhost
POSTGRES_PORT=5432

# Application
RESET_DB_ON_START=false
RESET_COOKIE_ON_START=true
APP_PORT=8000

# Security
SECRET_KEY=your-secret-key
ALGORITHM=HS256
ACCESS_TOKEN_EXPIRE=1440  # minutes
```

### Docker

**Dockerfile**:
- Base: Python 3.13-slim
- Package manager: uv
- Workdir: /app

**docker-compose.yml**:
- Service `app`: FastAPI –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
- Service `db`: PostgreSQL 17
- Volume –¥–ª—è –¥–∞–Ω–Ω—ã—Ö –ë–î

---

## –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏

### –û—Å–Ω–æ–≤–Ω—ã–µ (pyproject.toml)

- **FastAPI** 0.115.0 - Web framework
- **Uvicorn** - ASGI server
- **SQLAlchemy** 2.0.35 - ORM
- **asyncpg** 0.30.0 - PostgreSQL driver
- **Pydantic** 2+ - –í–∞–ª–∏–¥–∞—Ü–∏—è
- **PyJWT** 2.9.0 - JWT —Ç–æ–∫–µ–Ω—ã
- **Passlib[bcrypt]** - –•–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–∞—Ä–æ–ª–µ–π
- **Phonenumbers** - –í–∞–ª–∏–¥–∞—Ü–∏—è —Ç–µ–ª–µ—Ñ–æ–Ω–æ–≤

### Dev –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏

- **pytest** - –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
- **pytest-asyncio** - Async —Ç–µ—Å—Ç—ã

---
